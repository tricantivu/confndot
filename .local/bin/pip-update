#!/bin/sh

# Usage: pip-update [TYPE]
# Requirements: pip >= 23.1.2
#
# Examples:
#
#   $ pip-update sdist
#
#   $ pip-update wheel

argc=$# i=1

while read -r line; do

    # Skip header
    [ ${i} -eq 1 ] || [ ${i} -eq 2 ] && {

        i=$(( i + 1 ))
        continue
    }

    case "${line}" in
        (*'[notice]'*) continue ;;
        ('')           continue ;;
    esac

    i=$(( i + 1 ))

    [ "${line##*' '}" = "$1" ] && continue

    # Names are at the beginning of the line
    set -- "$@" "${line%%' '*}"

done << PACKAGES
$(pip list -o 2>&-)
PACKAGES

[ $# -eq 0 ] && {

    printf 'Nothing to update!\n'

    exit 0
}

shift ${argc}

exec pip install -U -- "$@"
